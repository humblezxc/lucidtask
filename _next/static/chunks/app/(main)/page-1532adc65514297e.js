(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[619],{4229:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>q});var a=r(5155),s=r(2115),n=r(920),i=r(7165),c=r(9853),u=r(5910),o=r(3504),l=r(2020),h=class extends u.Q{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=(0,o.T)(),this.options.experimental_prefetchInRender||this.#r.reject(Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}#e;#a=void 0;#s=void 0;#n=void 0;#i;#c;#r;#t;#u;#o;#l;#h;#d;#y;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#a.addObserver(this),d(this.#a,this.options)?this.#g():this.updateResult(),this.#p())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return y(this.#a,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return y(this.#a,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#f(),this.#v(),this.#a.removeObserver(this)}setOptions(e){let t=this.options,r=this.#a;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,l.Eh)(this.options.enabled,this.#a))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#a.setOptions(this.options),t._defaulted&&!(0,l.f8)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#a,observer:this});let a=this.hasListeners();a&&m(this.#a,r,this.options,t)&&this.#g(),this.updateResult(),a&&(this.#a!==r||(0,l.Eh)(this.options.enabled,this.#a)!==(0,l.Eh)(t.enabled,this.#a)||(0,l.d2)(this.options.staleTime,this.#a)!==(0,l.d2)(t.staleTime,this.#a))&&this.#x();let s=this.#R();a&&(this.#a!==r||(0,l.Eh)(this.options.enabled,this.#a)!==(0,l.Eh)(t.enabled,this.#a)||s!==this.#y)&&this.#Q(s)}getOptimisticResult(e){var t,r;let a=this.#e.getQueryCache().build(this.#e,e),s=this.createResult(a,e);return t=this,r=s,(0,l.f8)(t.getCurrentResult(),r)||(this.#n=s,this.#c=this.options,this.#i=this.#a.state),s}getCurrentResult(){return this.#n}trackResult(e,t){let r={};return Object.keys(e).forEach(a=>{Object.defineProperty(r,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),t?.(a),e[a])})}),r}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#a}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#g({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#g(e){this.#b();let t=this.#a.fetch(this.options,e);return e?.throwOnError||(t=t.catch(l.lQ)),t}#x(){this.#f();let e=(0,l.d2)(this.options.staleTime,this.#a);if(l.S$||this.#n.isStale||!(0,l.gn)(e))return;let t=(0,l.j3)(this.#n.dataUpdatedAt,e);this.#h=setTimeout(()=>{this.#n.isStale||this.updateResult()},t+1)}#R(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#a):this.options.refetchInterval)??!1}#Q(e){this.#v(),this.#y=e,!l.S$&&!1!==(0,l.Eh)(this.options.enabled,this.#a)&&(0,l.gn)(this.#y)&&0!==this.#y&&(this.#d=setInterval(()=>{(this.options.refetchIntervalInBackground||n.m.isFocused())&&this.#g()},this.#y))}#p(){this.#x(),this.#Q(this.#R())}#f(){this.#h&&(clearTimeout(this.#h),this.#h=void 0)}#v(){this.#d&&(clearInterval(this.#d),this.#d=void 0)}createResult(e,t){let r;let a=this.#a,s=this.options,n=this.#n,i=this.#i,u=this.#c,h=e!==a?e.state:this.#s,{state:y}=e,p={...y},f=!1;if(t._optimisticResults){let r=this.hasListeners(),n=!r&&d(e,t),i=r&&m(e,a,t,s);(n||i)&&(p={...p,...(0,c.k)(y.data,e.options)}),"isRestoring"===t._optimisticResults&&(p.fetchStatus="idle")}let{error:v,errorUpdatedAt:b,status:x}=p;if(t.select&&void 0!==p.data){if(n&&p.data===i?.data&&t.select===this.#u)r=this.#o;else try{this.#u=t.select,r=t.select(p.data),r=(0,l.pl)(n?.data,r,t),this.#o=r,this.#t=null}catch(e){this.#t=e}}else r=p.data;if(void 0!==t.placeholderData&&void 0===r&&"pending"===x){let e;if(n?.isPlaceholderData&&t.placeholderData===u?.placeholderData)e=n.data;else if(e="function"==typeof t.placeholderData?t.placeholderData(this.#l?.state.data,this.#l):t.placeholderData,t.select&&void 0!==e)try{e=t.select(e),this.#t=null}catch(e){this.#t=e}void 0!==e&&(x="success",r=(0,l.pl)(n?.data,e,t),f=!0)}this.#t&&(v=this.#t,r=this.#o,b=Date.now(),x="error");let R="fetching"===p.fetchStatus,Q="pending"===x,I="error"===x,w=Q&&R,j=void 0!==r,O={status:x,fetchStatus:p.fetchStatus,isPending:Q,isSuccess:"success"===x,isError:I,isInitialLoading:w,isLoading:w,data:r,dataUpdatedAt:p.dataUpdatedAt,error:v,errorUpdatedAt:b,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>h.dataUpdateCount||p.errorUpdateCount>h.errorUpdateCount,isFetching:R,isRefetching:R&&!Q,isLoadingError:I&&!j,isPaused:"paused"===p.fetchStatus,isPlaceholderData:f,isRefetchError:I&&j,isStale:g(e,t),refetch:this.refetch,promise:this.#r};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===O.status?e.reject(O.error):void 0!==O.data&&e.resolve(O.data)},r=()=>{t(this.#r=O.promise=(0,o.T)())},s=this.#r;switch(s.status){case"pending":e.queryHash===a.queryHash&&t(s);break;case"fulfilled":("error"===O.status||O.data!==s.value)&&r();break;case"rejected":("error"!==O.status||O.error!==s.reason)&&r()}}return O}updateResult(){let e=this.#n,t=this.createResult(this.#a,this.options);this.#i=this.#a.state,this.#c=this.options,void 0!==this.#i.data&&(this.#l=this.#a),!(0,l.f8)(t,e)&&(this.#n=t,this.#I({listeners:(()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#m.size)return!0;let a=new Set(r??this.#m);return this.options.throwOnError&&a.add("error"),Object.keys(this.#n).some(t=>this.#n[t]!==e[t]&&a.has(t))})()}))}#b(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#a)return;let t=this.#a;this.#a=e,this.#s=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#p()}#I(e){i.jG.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#n)}),this.#e.getQueryCache().notify({query:this.#a,type:"observerResultsUpdated"})})}};function d(e,t){return!1!==(0,l.Eh)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&y(e,t,t.refetchOnMount)}function y(e,t,r){if(!1!==(0,l.Eh)(t.enabled,e)){let a="function"==typeof r?r(e):r;return"always"===a||!1!==a&&g(e,t)}return!1}function m(e,t,r,a){return(e!==t||!1===(0,l.Eh)(a.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&g(e,r)}function g(e,t){return!1!==(0,l.Eh)(t.enabled,e)&&e.isStaleByTime((0,l.d2)(t.staleTime,e))}var p=r(6715),f=s.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),v=()=>s.useContext(f);function b(){}var x=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&!t.isReset()&&(e.retryOnMount=!1)},R=e=>{s.useEffect(()=>{e.clearReset()},[e])},Q=e=>{let{result:t,errorResetBoundary:r,throwOnError:a,query:s,suspense:n}=e;return t.isError&&!r.isReset()&&!t.isFetching&&s&&(n&&void 0===t.data||function(e,t){return"function"==typeof e?e(...t):!!e}(a,[t.error,s]))},I=s.createContext(!1),w=()=>s.useContext(I);I.Provider;var j=e=>{let t=e.staleTime;e.suspense&&(e.staleTime="function"==typeof t?(...e)=>Math.max(t(...e),1e3):Math.max(t??1e3,1e3),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,1e3)))},O=(e,t)=>e.isLoading&&e.isFetching&&!t,S=(e,t)=>e?.suspense&&t.isPending,C=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});let E=[{name:"name 1",category:"category 1",value:"",id:"1"},{name:"name 2",category:"category 2",value:"",id:"2"},{name:"name 3",category:"category 3",value:95,id:"3"},{name:"name 4",category:"category 4",value:3,id:"4"},{name:"name 5",category:"category 5",value:51,id:"5"},{name:"name 6",category:"category 6",value:87,id:"6"},{name:"name 7",category:"category 7",value:57,id:"7"},{name:"name 8",category:"category 8",value:6,id:"8"},{name:"name 9",category:"category 9",value:40,id:"9"},{name:"name 10",category:"category 10",value:44,id:"10"},{name:"name 11",category:"category 11",value:90,id:"11"},{name:"name 12",category:"category 12",value:0,id:"12"},{name:"name 13",category:"category 13",value:99,id:"13"},{name:"name 14",category:"category 14",value:95,id:"14"},{name:"name 15",category:"category 15",value:60,id:"15"},{name:"name 16",category:"category 16",value:8,id:"16"},{name:"name 17",category:"category 17",value:60,id:"17"},{name:"name 18",category:"category 18",value:98,id:"18"},{name:"name 19",category:"category 19",value:75,id:"19"},{name:"name 20",category:"category 20",value:94,id:"20"},{name:"name 21",category:"category 21",value:92,id:"21"},{name:"name 22",category:"category 22",value:61,id:"22"},{name:"name 23",category:"category 23",value:24,id:"23"},{name:"name 24",category:"category 24",value:13,id:"24"},{name:"name 25",category:"category 25",value:50,id:"25"},{name:"name 26",category:"category 26",value:97,id:"26"},{name:"name 27",category:"category 27",value:22,id:"27"},{name:"name 28",category:"category 28",value:47,id:"28"},{name:"name 29",category:"category 29",value:24,id:"29"},{name:"name 30",category:"category 30",value:20,id:"30"},{name:"name 31",category:"category 31",value:"9 + 10",id:"31"},{name:"name 31",category:"category 31",value:"9 + 10",id:"31"},{name:"name 32",category:"category 32",value:"9 + 10",id:"32"},{name:"name 33",category:"category 33",value:"9 + 10",id:"33"},{name:"name 34",category:"category 34",value:"9 + 10",id:"34"},{name:"name 34",category:"category 34",value:"9 + 10",id:"34"},{name:"name 35",category:"category 35",value:21,id:"35"},{name:"name 36",category:"category 36",value:77,id:"36"},{name:"name 37",category:"category 37",value:52,id:"37"},{name:"name 38",category:"category 38",value:70,id:"38"},{name:"name 39",category:"category 39",value:49,id:"39"},{name:"name 40",category:"category 40",value:10,id:"40"},{name:"name 41",category:"category 41",value:3,id:"41"},{name:"name 42",category:"category 42",value:5,id:"42"},{name:"name 43",category:"category 43",value:16,id:"43"},{name:"name 44",category:"category 44",value:72,id:"44"},{name:"name 45",category:"category 45",value:70,id:"45"}],T=e=>(function(e,t,r){var a,n,c,u,o;let h=(0,p.jE)(r),d=w(),y=v(),m=h.defaultQueryOptions(e);null===(n=h.getDefaultOptions().queries)||void 0===n||null===(a=n._experimental_beforeQuery)||void 0===a||a.call(n,m),m._optimisticResults=d?"isRestoring":"optimistic",j(m),x(m,y),R(y);let g=!h.getQueryCache().get(m.queryHash),[f]=s.useState(()=>new t(h,m)),I=f.getOptimisticResult(m),E=!d&&!1!==e.subscribed;if(s.useSyncExternalStore(s.useCallback(e=>{let t=E?f.subscribe(i.jG.batchCalls(e)):b;return f.updateResult(),t},[f,E]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),s.useEffect(()=>{f.setOptions(m)},[m,f]),S(m,I))throw C(m,f,y);if(Q({result:I,errorResetBoundary:y,throwOnError:m.throwOnError,query:h.getQueryCache().get(m.queryHash),suspense:m.suspense}))throw I.error;if(null===(u=h.getDefaultOptions().queries)||void 0===u||null===(c=u._experimental_afterQuery)||void 0===c||c.call(u,m,I),m.experimental_prefetchInRender&&!l.S$&&O(I,d)){let e=g?C(m,f,y):null===(o=h.getQueryCache().get(m.queryHash))||void 0===o?void 0:o.promise;null==e||e.catch(b).finally(()=>{f.updateResult()})}return m.notifyOnChangeProps?I:f.trackResult(I)})({queryKey:["suggestions",e],queryFn:async()=>(await new Promise(e=>setTimeout(e,300)),E.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()))),enabled:e.length>0},h,void 0),k=e=>{let t;let r=new Set,a=(e,a)=>{let s="function"==typeof e?e(t):e;if(!Object.is(s,t)){let e=t;t=(null!=a?a:"object"!=typeof s||null===s)?s:Object.assign({},t,s),r.forEach(r=>r(t,e))}},s=()=>t,n={setState:a,getState:s,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(a,s,n);return n},N=e=>e?k(e):k,D=e=>e,F=e=>{let t=N(e),r=e=>(function(e,t=D){let r=s.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return s.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},_=(e=>e?F(e):F)(e=>({tags:[],input:"",addTag:t=>e(e=>({tags:[...e.tags,t],input:""})),removeTag:t=>e(e=>({tags:e.tags.filter(e=>e.id!==t)})),setInput:t=>e({input:t}),clearAll:()=>e({tags:[],input:""})}));function P(e){let{tag:t}=e,[r,n]=(0,s.useState)(!1),{removeTag:i}=_();return(0,a.jsxs)("div",{className:"relative inline-block",children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-sm font-medium cursor-pointer ".concat((e=>{switch(e){case"variable":return"bg-blue-100 text-blue-800 hover:bg-blue-200";case"number":return"bg-green-100 text-green-800 hover:bg-green-200";case"operator":return"bg-gray-100 text-gray-800 hover:bg-gray-200";default:return"bg-gray-100 text-gray-800"}})(t.type)),onClick:()=>n(!r),children:[t.name,"number"==typeof t.value&&(0,a.jsxs)("span",{className:"ml-1 text-xs opacity-70",children:["(",t.value,")"]})]}),r&&(0,a.jsx)("div",{className:"absolute right-0 z-10 mt-1 w-48 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",onMouseLeave:()=>n(!1),children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-700",children:[(0,a.jsx)("div",{className:"font-medium",children:t.name}),t.category&&(0,a.jsx)("div",{className:"text-xs text-gray-500",children:t.category}),"number"==typeof t.value&&(0,a.jsxs)("div",{className:"text-xs",children:["Value: ",t.value]})]}),(0,a.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>{navigator.clipboard.writeText(t.name),n(!1)},children:"Copy"}),(0,a.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100",onClick:()=>{i(t.id),n(!1)},children:"Remove"})]})})]})}function U(){let{tags:e,input:t,addTag:r,removeTag:n,setInput:i}=_(),[c,u]=(0,s.useState)(!1),o=(0,s.useRef)(null),{data:l,isLoading:h}=T(t);return(0,a.jsxs)("div",{className:"w-full max-w-2xl p-4 mx-auto space-y-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Formula"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 p-3 border border-gray-300 rounded-lg shadow-sm focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500 min-h-12 bg-white",onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()},children:[e.map(e=>(0,a.jsx)(P,{tag:e},e.id)),(0,a.jsx)("input",{ref:o,className:"flex-1 min-w-[50px] outline-none bg-transparent text-gray-900 placeholder-gray-400",value:t,onChange:e=>i(e.target.value),onKeyDown:a=>{if("Backspace"===a.key&&""===t&&e.length>0){n(e[e.length-1].id);return}(" "===a.key||["+","-","*","/","^","(",")"].includes(a.key))&&(""!==t.trim()&&r({id:"".concat(t,"-").concat(Date.now()),name:t.trim(),category:"",value:"",type:isNaN(Number(t.trim()))?"variable":"number"}),["+","-","*","/","^","(",")"].includes(a.key)&&(r({id:"op-".concat(Date.now()),name:a.key,category:"operator",value:a.key,type:"operator"}),a.preventDefault()))},onFocus:()=>u(!0),onBlur:()=>setTimeout(()=>u(!1),200),placeholder:0===e.length?"Type to add variables...":""})]}),c&&t.length>0&&(0,a.jsx)("div",{className:"absolute z-10 w-full mt-1 overflow-auto bg-white rounded-md shadow-lg max-h-60 ring-1 ring-black ring-opacity-5",children:h?(0,a.jsx)("div",{className:"px-4 py-2 text-gray-500",children:"Loading..."}):(null==l?void 0:l.length)===0?(0,a.jsx)("div",{className:"px-4 py-2 text-gray-500",children:"No suggestions found"}):null==l?void 0:l.map(e=>(0,a.jsxs)("div",{className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",onMouseDown:e=>e.preventDefault(),onClick:()=>{var t;r({...e,type:"variable"}),i(""),null===(t=o.current)||void 0===t||t.focus()},children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),e.category&&(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.category})]},e.id))})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,a.jsx)("p",{children:"Available operators: + - * / ^ ( )"}),(0,a.jsx)("p",{children:"Press space to complete variables"})]})]})}function q(){return(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("h1",{children:"Formula Input"}),(0,a.jsx)(U,{})]})}},9738:(e,t,r)=>{Promise.resolve().then(r.bind(r,4229))}},e=>{var t=t=>e(e.s=t);e.O(0,[967,441,684,358],()=>t(9738)),_N_E=e.O()}]);